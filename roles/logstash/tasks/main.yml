---
- name: Update APT package manager repositories cache
  become: true
  apt:
    update_cache: yes

- name: Install OpenJDK Java
  become: yes
  apt:
    name: "{{ item }}"
    state: present
  with_items:
    openjdk-8-jdk

- name: Set JAVA_HOME
  become: true
  shell: | 
    sed -i "1i\JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64" /etc/environment


- name: install logstash
  become: true
  shell: | 
    wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | apt-key add -
    echo "deb https://artifacts.elastic.co/packages/oss-7.x/apt stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-7.x.list
    apt-get update 
    apt-get install logstash
    systemctl enable logstash
  notify: restart logstash
